10 REM APPLEMS - AppleSoft MS-BASIC Compatibility Layer
20 REM Load and RUN this file to get helper subroutines that emulate a small subset of MS-BASIC.
30 REM Author: Generated by copilot
40 REM -----------------------------------------------------------------------------
100 REM --- Demo/startup ---------------------------------------------------------
110 HOME
120 PRINT "APPLEMS - MS-BASIC Compatibility Layer"
130 PRINT
140 PRINT "Demo: LEFT$, RIGHT$, INSTR, INTDIV, MOD"
150 PRINT
160 S$ = "HELLO, WORLD"
170 N = 5
180 REM LEFT$ example: set S$ and N then GOSUB 3000; result in R$
190 S$ = S$: N = 5
200 GOSUB 3000 : PRINT "LEFT$(";S$;",";N;") -> "; R$
210 REM RIGHT$ example: set S$ and N then GOSUB 3100; result in R$
220 S$ = "APPLESOFT" : N = 4
230 GOSUB 3100 : PRINT "RIGHT$(";S$;",";N;") -> "; R$
240 REM INSTR example: set S$, T$ then GOSUB 3300; result in P
250 S$ = "THE QUICK BROWN FOX" : T$ = "BROWN"
260 GOSUB 3300 : PRINT "INSTR(";S$;",";T$;") -> "; P
270 REM INTDIV and MOD example: set A and B then GOSUB 4000/4100
280 A = -17 : B = 4
290 GOSUB 4000 : PRINT "INTDIV(";A;",";B;") -> "; Q
300 GOSUB 4100 : PRINT "MOD(";A;",";B;") -> "; R
310 PRINT
320 PRINT "End of demo. Use the subroutines in your programs by calling GOSUB."
330 END

3000 REM LEFT$ (inputs: S$, N) -> output: R$
3010 R$ = ""
3020 IF N <= 0 THEN R$ = "" : RETURN
3030 IF N >= LEN(S$) THEN R$ = S$ : RETURN
3040 R$ = MID$(S$,1,N)
3050 RETURN

3100 REM RIGHT$ (inputs: S$, N) -> output: R$
3110 L = LEN(S$)
3120 IF N <= 0 THEN R$ = "" : RETURN
3130 IF N >= L THEN R$ = S$ : RETURN
3140 R$ = MID$(S$,L-N+1,N)
3150 RETURN

3300 REM INSTR (inputs: S$, T$) -> output: P (1-based index, 0 if not found)
3310 P = 0
3320 LS = LEN(S$) : LT = LEN(T$)
3330 IF LT = 0 THEN P = 1 : RETURN
3340 IF LT > LS THEN P = 0 : RETURN
3350 FOR I = 1 TO LS - LT + 1
3360 IF MID$(S$,I,LT) = T$ THEN P = I : RETURN
3370 NEXT I
3380 P = 0
3390 RETURN

4000 REM INTDIV (inputs: A, B) -> output: Q (integer division truncated toward zero)
4010 IF B = 0 THEN Q = 0 : RETURN
4020 AN = A : BN = B
4030 SA = 1 : IF AN < 0 THEN SA = -1 : AN = -AN
4040 SB = 1 : IF BN < 0 THEN SB = -1 : BN = -BN
4050 Q = INT(AN / BN)
4060 IF SA * SB < 0 THEN Q = -Q
4070 RETURN

4100 REM MOD (inputs: A, B) -> output: R (remainder matching INTDIV above)
4110 IF B = 0 THEN R = 0 : RETURN
4120 GOSUB 4000 : REM computes Q
4130 R = A - Q * B
4140 RETURN